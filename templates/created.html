<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Secret Created</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card shadow">
            <div class="card-body text-center">
              <h2 class="mb-4">Secret Link Created!</h2>
              <p class="mb-3">Share this link with your recipient. It will expire in <b>{{ expire }}</b> minutes or after being read once.</p>
              <div class="alert alert-success d-flex flex-column flex-sm-row align-items-center justify-content-between gap-2" role="region" aria-live="polite">
                <a href="{{ link }}" class="text-break flex-grow-1" id="secret-link" tabindex="0">{{ link }}</a>
                <button class="btn btn-outline-primary btn-sm mt-2 mt-sm-0" id="copy-btn" aria-label="Copy secret link" type="button">
                  <span id="copy-btn-text">Copy</span>
                </button>
              </div>
              <div class="mb-3">
                <span id="countdown" class="fw-bold" aria-live="polite" aria-atomic="true"></span>
              </div>
              <a href="/" class="btn btn-secondary mt-3">Create Another</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    // Copy to clipboard functionality
    document.addEventListener('DOMContentLoaded', function() {
      var copyBtn = document.getElementById('copy-btn');
      var link = document.getElementById('secret-link');
      var copyBtnText = document.getElementById('copy-btn-text');
      if (copyBtn && link) {
        copyBtn.addEventListener('click', function() {
          navigator.clipboard.writeText(link.href).then(function() {
            copyBtnText.textContent = 'Copied!';
            copyBtn.setAttribute('aria-label', 'Link copied');
            setTimeout(function() {
              copyBtnText.textContent = 'Copy';
              copyBtn.setAttribute('aria-label', 'Copy secret link');
            }, 1500);
          });
        });
      }
      // Countdown timer
      var countdownEl = document.getElementById('countdown');
      var expireAt = {{ expire_at }} * 1000;
      function updateCountdown() {
        var now = Date.now();
        var diff = Math.max(0, Math.floor((expireAt - now) / 1000));
        var min = Math.floor(diff / 60);
        var sec = diff % 60;
        if (diff > 0) {
          countdownEl.textContent = 'Expires in ' + min + 'm ' + sec.toString().padStart(2, '0') + 's';
        } else {
          countdownEl.textContent = 'This link has expired.';
        }
      }
      if (countdownEl) {
        updateCountdown();
        var timer = setInterval(function() {
          updateCountdown();
          if (Date.now() >= expireAt) clearInterval(timer);
        }, 1000);
      }
    });
  </script>
</html> 